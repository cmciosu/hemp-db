{% extends "master.html" %}

{% block title %}
  HempDB - Map
{% endblock %}

{% block content %}
  <h3 class="d-flex justify-content-center mt-2">HempDB Companies Map</h3>

  {{ companies|json_script:"company_data"}}

  <div id="map" style="height: 700px;"></div>
  <script>
    var map = L.map('map').setView([39.833333, -98.583333], 5); // Center map around U.S.

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 20,
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

    const companies = JSON.parse(document.getElementById('company_data').textContent);

    // Add markers for each company lat/lng
    companies.forEach(company => {
      L.marker([company.Latitude, company.Longitude]).addTo(map)
    })
  </script>
{% endblock %}